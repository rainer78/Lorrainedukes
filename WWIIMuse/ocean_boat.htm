<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>A-Frame Hand Tracking and Gesture Detection</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
</head>
<body>
    <a-scene webxr="requiredFeatures: hand-tracking">
        <!-- Hand entities for tracking -->
        <a-entity id="leftHand" hand-tracking="hand: left"></a-entity>
        <a-entity id="rightHand" hand-tracking="hand: right"></a-entity>

        <!-- Clickable box -->
        <a-box position="0 1.5 -3" rotation="0 45 0" color="#4CC3D9" clickable></a-box>
        
        <!-- Camera -->
        <a-camera position="0 1.6 0"></a-camera>
    </a-scene>

    <script>
        // Hand Tracking Component
        AFRAME.registerComponent('hand-tracking', {
            schema: { hand: { type: 'string', default: 'left' } },

            tick: function () {
                const hand = this.el.getObject3D('mesh');
                if (!hand) return;

                const indexTip = hand.joints['index-finger-tip'];
                const thumbTip = hand.joints['thumb-tip'];

                if (indexTip && thumbTip) {
                    const distance = indexTip.position.distanceTo(thumbTip.position);
                    if (distance < 0.03) { // Threshold for pinch gesture, adjust as needed
                        this.el.emit('pinchdetected');
                    }
                }
            }
        });

        // Clickable Component
        AFRAME.registerComponent('clickable', {
            init: function () {
                this.el.addEventListener('pinchdetected', () => {
                    this.onPinch();
                });
            },

            onPinch: function () {
                // Action to perform on pinch, e.g., change color
                this.el.setAttribute('color', '#' + Math.floor(Math.random()*16777215).toString(16)); // Change to a random color
                console.log('Pinch detected on clickable entity');
            }
        });
    </script>
</body>
</html>
